<div th:fragment="widget">
    <!-- Кнопка для открытия чата -->
    <button id="openChatBtn" class="btn btn-primary rounded-circle shadow" style="position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; z-index: 1060; display: flex; align-items: center; justify-content: center; font-size: 2rem;">
        <i class="bi bi-chat-dots"></i>
    </button>

    <!-- Сам виджет чата -->
    <div id="chatWidget" class="card shadow-lg animate__animated animate__fadeInUp" style="display:none; position: fixed; bottom: 30px; right: 30px; width: 370px; z-index: 1070; border-radius: 1rem; overflow: hidden;">
        <div class="card-header d-flex align-items-center bg-primary text-white" style="border-bottom: 1px solid #e5e5e5;">
            <img src="/static/img/logo.png" alt="Lodgify" width="36" height="36" class="rounded-circle me-2 border border-white">
            <div>
                <div class="fw-bold">Lodgify Chat</div>
                <div class="text-white-50" style="font-size: 0.9em;">Онлайн</div>
            </div>
            <button type="button" class="btn-close btn-close-white ms-auto" aria-label="Close" onclick="toggleChat()"></button>
        </div>
        <div class="card-body p-0" style="background: #f7f7f7; max-height: 420px; overflow-y: auto;">
            <div class="p-3 border-bottom bg-white">
                <div class="text-muted small">Объявление</div>
                <div class="fw-bold">Квартира на Арбате</div>
                <a href="#" class="text-primary small">Перейти <i class="bi bi-box-arrow-up-right"></i></a>
            </div>
            <div class="p-3">
                <div class="bg-primary text-white rounded-4 p-3 mb-3 ms-auto" style="max-width: 80%;">
                    Здравствуйте!<br>
                    <span class="text-white-50 small">Готовы обсудить детали аренды?</span>
                    <div class="text-end small">12:34</div>
                </div>
                <div class="text-center text-muted small mb-3">Менеджер Lodgify присоединился к чату</div>
                <div class="bg-light rounded-4 p-3 mb-3" style="max-width: 80%;">
                    Добрый день! Да, квартира свободна. Могу ответить на ваши вопросы.
                    <div class="text-end small text-muted">12:35</div>
                </div>
                <div class="bg-light rounded-4 p-3 mb-2" style="max-width: 80%;">
                    Хотите записаться на просмотр?
                    <div class="text-end small text-muted">12:36</div>
                    <div class="mt-2 d-flex gap-2">
                        <button class="btn btn-outline-primary btn-sm flex-fill">Да</button>
                        <button class="btn btn-outline-primary btn-sm flex-fill">Нет</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-footer bg-white p-2 border-0">
            <div class="input-group">
                <input type="text" class="form-control rounded-start-pill" placeholder="Введите сообщение...">
                <button class="btn btn-primary rounded-end-pill" type="button"><i class="bi bi-send"></i></button>
            </div>
        </div>
    </div>

    <script>
        function toggleChat() {
            const widget = document.getElementById('chatWidget');
            const openBtn = document.getElementById('openChatBtn');
            if (widget.style.display === 'none' || widget.style.display === '') {
                widget.style.display = 'block';
                openBtn.style.display = 'none';
            } else {
                widget.style.display = 'none';
                openBtn.style.display = 'flex';
            }
        }
        document.getElementById('openChatBtn').onclick = toggleChat;
    </script>
    <!-- Для анимаций можно подключить animate.css или использовать свои -->
</div>
